{% extends "program_base.html" %}

{% load wagtailcore_tags %}
{% load wagtailimages_tags %}
{% load utilities %}

{% block body_class %}template-programblogpostspage{% endblock %}

{% block content %}
	<h1 class="content-grid__title"> {{ page.title }} </h1>

	{% if program.get_subprograms|length > 1 %}
	<div class="tags">
		<ul class="tags__taglist">
			<li class="tags__title">Topics</h3>
			{% for subprogram in program.get_subprograms %}
				<li class="label"><a>{{ subprogram }}</a></li>
			{% endfor %}
		</ul>
	</div>
	{% endif %}
	

	{% with post=all_posts|first %}
		<div class='blog-lead-story'>
			<div class='hero-grid has-1-children'>
				<div class='hero-grid__main'>
					<div class='hero-grid__element'>
					<a href="{{ post.url }}">
						<div class='hero-grid__element__wrapper'>
						{% image post.story_image original as post_image %}
							<div class='hero-grid__element__background' style='background-image: url({{ post_image.url }})'></div>
							<div class='hero-grid__element__overlay'></div>
							<div class='hero-grid__element__text-bar'>
								<h1 class='hero-grid__element__text-bar__heading'>{{ post.title }}</h1>
								{% if post.post_author.all %}
									<p class='hero-grid__element__text-bar__subheading' href="{{ post.url }}">By 
									{% for author in post.post_author.all %}
										{{ author.first_name }} {{author.last_name }}{% listify forloop.revcounter0 %}
									{% endfor %}
									</p>
								{% endif %}
								
							</div>
						</div>
					</a>
					</div>
				</div>
			</div>
		</div>
	{% endwith %}


	<div class="content-grid__entries blog">
		
		{% for post in all_posts %}
			<div class="content-entry">
				{% if post.story_image %}
					{% image post.story_image original as post_image %}

					<div class="content-entry__image-container">
						<a href="{{ post.url }}"><img class="content-entry__image" src="{{post_image.url}}"></a>
					</div>
				<div class="content-entry__text-container has-image">
				
				{% else %}
				<div class="content-entry__text-container">
				{% endif %}
					<div class="content-entry__text">
						{% if post.post_subprogram.all %}
							<h5 class="content-entry__text__program">
							{% for subprogram in post.post_subprogram.all %}
								<a href="{{ subprogram.url }}"> {{ subprogram | upper }}</a>{% listify forloop.revcounter0 %}
							{% endfor %}
							</h5>
						{% endif %}
						<h5 class= "content-entry__text__title"><a href="{{ post.url }}">{{ post.title }}</a></h5>

						{{ post.sub_headline }}

						{% if post.post_author.all %}
							<h5 class= "content-entry__text__author">By
							{% for author in post.post_author.all %}
								<a href="{{ author.url }}">{{author.first_name }} {{author.last_name }}</a>{% listify forloop.revcounter0 %}
							{% endfor %}
							</h5>
						{% endif %}
						<h5 class= "content-entry__text__date">{{ post.date }} </h5>
						<p class= "content-entry__text__excerpt">{{ post.story_excerpt }}</p>
						
					</div>
				</div>
			<hr>
			</div>
			
		{% endfor %}

	</div>
{% endblock %}